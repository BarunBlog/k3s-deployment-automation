apiVersion: rabbitmq.com/v1beta1
kind: RabbitmqCluster
metadata:
  name: rabbitmq
spec:
  replicas: 3
  image: rabbitmq:4.1.0-management-alpine

  # This tells the operator to use existing secret instead of generating one
  defaultUser:
    secretReference:
      name: rabbitmq-secret

  rabbitmq:
    additionalConfig: |
      management_path_prefix = /rabbitmq

  persistence:
    storageClassName: ebs-sc # Ensure this matches your storage/ manifest
    storage: 5Gi

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 500m
      memory: 1Gi